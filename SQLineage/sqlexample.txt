FROM
(
(
	SELECT
	  POH.company_id AS company_id,
	  POH.POHeadID AS POH_POHeadID,
	  POH.PONumber AS POH_PONumber,
	  POH.VendorID AS POH_VendorID,
	  POH.ShipToID AS POH_ShipToID,
	  POH.Buyer AS POH_Buyer,
	  POH.PODate AS POH_PODate,
	  POH.ReleaseFlag AS POH_ReleaseFlag,
	  POH.Ship AS POH_Ship,
	  POH.CountryID AS POH_CountryID,
	  POH.POComment AS POH_POComment,
	  POH.POCommentNP AS POH_POCommentNP,
	  POH.FOBID AS POH_FOBID,
	  POH.Terms AS POH_Terms,
	  POH.Reference AS POH_Reference,
	  POH.ShipToName AS POH_ShipToName,
	  POH.ShipToAddress AS POH_ShipToAddress,
	  POH.ShipToCity AS POH_ShipToCity,
	  POH.ShipToState AS POH_ShipToState,
	  POH.ShipToZip AS POH_ShipToZip,
	  POH.ShipToPhone AS POH_ShipToPhone,
	  POH.ShipToFax AS POH_ShipToFax,
	  POH.ShipToContact AS POH_ShipToContact,
	  POH.ForeignMade AS POH_ForeignMade,
	  POH.FOBSpecial AS POH_FOBSpecial,
	  CASE WHEN POH.ShipToType = 0 THEN 'company_id Warehouse' ELSE 'Direct to Customer' END  AS POH_ShipToType,
	  POH.TermsID AS POH_TermsID,
	  POH.FrtCWT AS POH_FrtCWT,
	  POH.FrtAmt AS POH_FrtAmt,
	  CASE WHEN POH.PrintFreight = 1 THEN 'True' ELSE 'False' END AS POH_PrintFreight,
	  POH.RFQNumber AS POH_RFQNumber,
	  POH.RFQDate AS POH_RFQDate,
	  POH.ProcessingPO AS POH_ProcessingPO,
	  POH.WarehouseID AS POH_WarehouseID,
	  POH.BlanketPO AS POH_BlanketPO,
	  CASE WHEN POH.NonInvPO = 1 THEN 'True' ELSE 'False' END AS POH_NonInvPO,
	  POH.FlatFrtAmt AS POH_FlatFrtAmt,
	  POH.CountryCode AS POH_CountryCode,
	  POH.BatchPrintStatus AS POH_BatchPrintStatus,
	  POH.PODueDate AS POH_PODueDate,
	  POL.POLineID AS POL_POLineID,
	  POL.POHeadID AS POL_POHeadID,
	  POL.InventoryID AS POL_InventoryID,
	  POL.ItemID AS POL_ItemID,
	  POL.ShiptoID AS POL_ShiptoID,
	  POL.Pieces AS POL_Pieces,
	  POL.Weight AS POL_Weight,
	  POL.Feet AS POL_Feet,
	  POL.Width AS POL_Width,
	  POL.Width1 AS POL_Width1,
	  POL.Length AS POL_Length,
	  POL.Length1 AS POL_Length1,
	  POL.Price AS POL_Price,
	  POL.UM AS POL_UM,
	  POL.Amount AS POL_Amount,
	  POL.Description AS POL_Description,
	  POL.MiscINfo AS POL_MiscINfo,
	  POL.Flaws00 AS POL_Flaws00,
	  POL.Chemistry AS POL_Chemistry,
	  POL.VendorTagNum AS POL_VendorTagNum,
	  POL.DueDate AS POL_DueDate,
	  POL.RollDate AS POL_RollDate,
	  POL.ChangeDt AS POL_ChangeDt,
	  POL.Release AS POL_Release,
	  POL.Comment AS POL_Comment,
	  POL.Commentnp AS POL_Commentnp,
	  POL.CommentReceiving AS POL_CommentReceiving,
	  POL.CommentSales AS POL_CommentSales,
	  POL.Paperwrap AS POL_Paperwrap,
	  POL.SideUnload AS POL_SideUnload,
	  POL.RearUnload AS POL_RearUnload,
	  POL.Spacers AS POL_Spacers,
	  POL.ForkLift AS POL_ForkLift,
	  POL.CountryID AS POL_CountryID,
	  POL.LineNum AS POL_LineNum,
	  CASE WHEN POL.Received = 1 THEN 'True' ELSE 'False' END AS POL_Received,
	  CASE WHEN POL.LockActualCost = 1 THEN 'True' ELSE 'False' END  AS POL_LockActualCost,
	  POL.FrtCWT AS POL_FrtCWT,
	  POL.FrtAmt AS POL_FrtAmt,
	  POL.HideWidthLength AS POL_HideWidthLength,
	  POL.DirectBuyout AS POL_DirectBuyout,
	  POL.PromiseDate AS POL_PromiseDate,
	  POL.FirmDate AS POL_FirmDate,
	  POL.Thickness AS POL_Thickness,
	  POL.GaugeMin AS POL_GaugeMin,
	  POL.GaugeMax AS POL_GaugeMax,
	  POL.GainPercent AS POL_GainPercent,
	  CASE WHEN POL.GainOverride = 1 THEN 'True' ELSE 'False' END AS POL_GainOverride,
	  POL.CustomerID AS POL_CustomerID,
	  POL.ClassificationID AS POL_ClassificationID
	  FROM
	  (SELECT * FROM Eniteo_Bassem.dbo.POHead WHERE last_record_flag = 1 AND Deleted_After = 0) POH
	  LEFT OUTER JOIN
	  (SELECT * FROM Eniteo_Bassem.dbo.POLine WHERE last_record_flag = 1 AND Deleted_After = 0) POL
	  ON (POH.POHeadId = POL.POHeadId
	  AND POH.company_id = POL.company_id)
)b
)a